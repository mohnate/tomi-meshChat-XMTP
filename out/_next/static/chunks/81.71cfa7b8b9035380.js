(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{4201:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ed}});var r,s=t(50029),i=t(87794),a=t.n(i),o=t(9008),c=t.n(o),l=t(41664),u=t.n(l),d=t(31407),x=t(67294),f=t(11163),m=t(85893),h=function(e){var n=e.children,t="/"===(0,f.useRouter)().pathname;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.u.Root,{show:t,as:x.Fragment,children:(0,m.jsx)("div",{className:"fixed inset-0 flex bg-white md:hidden",children:(0,m.jsx)(d.u.Child,{as:x.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:(0,m.jsx)("div",{className:"relative flex-1 flex flex-col w-full bg-white",children:n})})})}),(0,m.jsx)("div",{className:"hidden md:flex",children:n})]})},p=function(e){var n=e.children,t="/"!==(0,f.useRouter)().pathname;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.u.Root,{show:t,as:x.Fragment,children:(0,m.jsx)("div",{className:"md:hidden inset-0 flex flex-col h-screen bg-white ",children:(0,m.jsx)(d.u.Child,{as:x.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,m.jsx)("div",{className:"md:hidden relative flex-1 flex flex-col w-full",children:n})})})}),(0,m.jsx)("div",{className:"hidden md:bg-white md:pl-84 md:flex md:flex-col md:flex-1 md:h-screen",children:n})]})},v=t(77165),b=function(){var e=(0,f.useRouter)();return(0,m.jsx)("button",{className:"inline-flex items-center h-7 md:h-6 px-4 py-1 my-4 bg-p-400 border border-p-300 hover:bg-p-300 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-n-100 focus-visible:ring-offset-p-600 focus-visible:border-n-100 focus-visible:outline-none active:bg-p-500 active:border-p-500 active:ring-0 text-sm md:text-xs md:font-semibold tracking-wide text-white rounded",onClick:function(){e.push("/dm/")},children:"+ New Message"})},g=t(77082),w=t(4664),j=t(98519),y=t(66293),k=t(61622),N=t(2852),C=t(39631),A=function(e){var n,t,r=e.conversation,s=(0,f.useRouter)(),i=(0,j.q)(function(e){return e.address}),a=(0,j.q)(function(e){return e.previewMessages}),o=(0,j.q)(function(e){return e.loadingConversations}),c=(0,x.useState)(),l=c[0],u=c[1];if((0,x.useEffect)(function(){var e;u(null!==(e=Array.isArray(s.query.recipientWalletAddr)?s.query.recipientWalletAddr.join("/"):s.query.recipientWalletAddr)&&void 0!==e?e:"")},[s.query.recipientWalletAddr]),(0,x.useEffect)(function(){!l&&window.location.pathname.includes("/dm")&&(s.push(window.location.pathname),u(window.location.pathname.replace("/dm/","")))},[l,window.location.pathname]),!a.get((0,N.n2)(r)))return null;var d=a.get((0,N.n2)(r)),h=null!==(n=null===(t=r.context)||void 0===t?void 0:t.conversationId.split("/")[0])&&void 0!==n?n:"",p=l===(0,N.n2)(r);if(!d)return null;var v=function(e){s.push(e)};return(0,m.jsxs)("div",{onClick:function(){return v("/dm/".concat((0,N.n2)(r)))},className:(0,N.AK)("h-20","py-2","px-4","md:max-w-sm","mx-auto","bg-white","space-y-2","py-2","flex","items-center","space-y-0","space-x-4","border-b-2","border-gray-100","hover:bg-bt-100","cursor-pointer",o?"opacity-80":"opacity-100",p?"bg-bt-200":null),children:[(0,m.jsx)(C.Z,{peerAddress:r.peerAddress}),(0,m.jsxs)("div",{className:"py-4 sm:text-left text w-full",children:[h&&(0,m.jsx)("div",{className:"text-sm rounded-2xl text-white bg-black w-max px-2 font-bold",children:h.toLocaleUpperCase()}),(0,m.jsxs)("div",{className:"grid-cols-2 grid",children:[(0,m.jsx)(k.Z,{address:r.peerAddress,className:"text-black text-lg md:text-md font-bold place-self-start"}),(0,m.jsx)("span",{className:(0,N.AK)("text-lg md:text-sm font-normal place-self-end",p?"text-n-500":"text-n-300",o?"animate-pulse":""),children:(0,N.p6)(null==d?void 0:d.sent)})]}),(0,m.jsxs)("span",{className:"text-sm text-gray-500 line-clamp-1 break-all",children:[i===(null==d?void 0:d.senderAddress)&&"You: "," ",null==d?void 0:d.content]})]})]})},q=function(){return(0,m.jsx)("div",{className:"flex flex-col flex-grow justify-center h-[100%]",children:(0,m.jsxs)("div",{className:"flex flex-col items-center px-4 text-center",children:[(0,m.jsx)(y.Z,{className:"h-8 w-8 mb-1 stroke-n-200 md:stroke-n-300","aria-hidden":"true"}),(0,m.jsx)("p",{className:"text-xl md:text-lg text-n-200 md:text-n-300 font-bold",children:"Your message list is empty"}),(0,m.jsx)("p",{className:"text-lx md:text-md text-n-200 font-normal",children:"There are no messages for this address"})]})})},T=x.memo(function(){var e=(0,j.q)(function(e){return e.conversations}),n=(0,j.q)(function(e){return e.previewMessages});return e&&0!=e.size?(0,m.jsx)(m.Fragment,{children:e&&e.size>0&&Array.from(e.values()).sort(function(e,t){var r,s;return((null===(r=n.get((0,N.n2)(e)))||void 0===r?void 0:r.sent)||new Date)<((null===(s=n.get((0,N.n2)(t)))||void 0===s?void 0:s.sent)||new Date)?1:-1}).map(function(e){return(0,m.jsx)(A,{conversation:e},(0,N.n2)(e))})}):(0,m.jsx)(q,{})}),Z=t(36121),I=function(e){var n=e.children;return(0,m.jsxs)("div",{className:"flex flex-col flex-grow justify-center",children:[(0,m.jsxs)("div",{className:"flex flex-col items-center px-4 text-center",children:[(0,m.jsx)(g.Z,{className:"h-8 w-8 mb-1 stroke-n-200 md:stroke-n-300","aria-hidden":"true"}),(0,m.jsx)("p",{className:"text-xl md:text-lg text-n-200 md:text-n-300 font-bold",children:"No wallet connected"}),(0,m.jsx)("p",{className:"text-lx md:text-md text-n-200 font-normal",children:"Please connect a wallet to begin"})]}),n]})},P=function(e){var n=e.onConnect;return(0,m.jsx)("button",{onClick:n,className:"rounded border border-l-300 mx-auto my-4 text-l-300 hover:text-white hover:bg-l-400 hover:border-l-400 hover:fill-white focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-n-100 focus-visible:outline-none active:bg-l-500 active:border-l-500 active:text-l-100 active:ring-0",children:(0,m.jsxs)("div",{className:"flex items-center justify-center text-xs font-semibold px-4 py-1",children:["Connect your wallet",(0,m.jsx)(w.Z,{className:"h-4"})]})})},S=function(){var e=(0,j.q)(function(e){return e.client}),n=(0,j.q)(function(e){return e.loadingConversations});return void 0===e?(0,m.jsx)(Z.ZP,{headingText:"Awaiting signatures...",subHeadingText:"Use your wallet to sign",isLoading:!0}):n?(0,m.jsx)(Z.ZP,{headingText:"Loading conversations...",subHeadingText:"Please wait a moment",isLoading:!0}):(0,m.jsx)("nav",{className:"flex-1 pb-4",children:(0,m.jsx)(T,{})})},E=function(e){var n=e.onConnect,t=(0,j.q)(function(e){return e.address}),r=(0,j.q)(function(e){return e.client});return(0,m.jsx)("div",{className:"flex-grow flex flex-col h-[calc(100vh-8rem)] overflow-y-auto",children:t&&null!==r?(0,m.jsx)(S,{}):(0,m.jsx)(I,{children:(0,m.jsx)(P,{onConnect:n})})})},M=t(4147),F=t(51183),H=t(4564),_=t(93481),O=t(18302),R=function(e){var n=e.icon,t=e.headingText,r=e.subHeadingText,s=e.onClick,i=e.disabled;return(0,m.jsx)("a",{onClick:i?void 0:s,className:i?"cursor-auto":"cursor-pointer",children:(0,m.jsxs)("div",{className:(0,N.AK)(i?"opacity-40":"","flex py-4 border border-x-0 border-y-zinc-50 justify-between items-stretch text-left"),children:[(0,m.jsx)("div",{className:"h-10 w-10 bg-l-300 rounded-lg text-white p-2",children:n}),(0,m.jsxs)("div",{className:"ml-3 flex-col justify-center text-md flex-1",children:[(0,m.jsx)("div",{className:"font-semibold text-n-600",children:t}),(0,m.jsx)("div",{className:"text-n-300",children:r})]}),(0,m.jsx)("div",{className:"w-10 flex justify-end items-center pr-2",children:(0,m.jsx)(F.Z,{className:"h-5"})})]})})},D=function(e){var n=e.onConnect,t=(0,j.q)(function(e){return e.address}),r=[{icon:(0,m.jsx)(H.Z,{}),headingText:"Connect your wallet",subHeadingText:"Verify your wallet to start using the XMTP protocol",onClick:n,disabled:!!t},{icon:(0,m.jsx)(_.Z,{}),headingText:"Read the docs",subHeadingText:"Check out the documentation for our protocol and find out how to get up and running quickly",onClick:function(){return window.open("https://docs.xmtp.org","_blank")}},{icon:(0,m.jsx)(O.Z,{}),headingText:"Join our community",subHeadingText:"Talk about what youâ€™re building or find out other projects that are building upon XMTP",onClick:function(){return window.open("https://community.xmtp.org","_blank")}}];return(0,m.jsxs)("div",{className:"hidden md:block m-auto w-[464px]",children:[(0,m.jsxs)("div",{className:"pb-6",children:[(0,m.jsx)("div",{className:"text-xl text-n-600 font-semibold mb-1",children:"Welcome to the web3 communication protocol"}),(0,m.jsx)("div",{className:"text-md text-n-300",children:"Get started by reading the docs or joining the community"})]}),(0,m.jsx)("div",{children:r.map(function(e,n){return(0,m.jsx)(R,{icon:e.icon,headingText:e.headingText,subHeadingText:e.subHeadingText,onClick:e.onClick,disabled:e.disabled},n)})}),(0,m.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,m.jsxs)("div",{className:"text-n-600 text-sm",children:["xmtp-js v",M.HO.Ay.substring(1)]}),(0,m.jsxs)("a",{href:"https://blog.xmtp.com/contact/",target:"_blank",className:"text-l-300 font-semibold text-md flex items-center",rel:"noreferrer",children:["I need help ",(0,m.jsx)(w.Z,{className:"h-5 fill-l-300"})]})]})]})},W=t(74014),K=t(22659),L=function(e){var n=e.message,t=e.children;return(0,m.jsxs)("div",{className:"relative flex flex-col items-center group",children:[t,(0,m.jsxs)("div",{className:"w-32 absolute bottom-0 flex flex-col items-center hidden mb-6 group-hover:flex",children:[(0,m.jsx)("span",{className:"relative z-10 p-2 text-sm leading-none text-white whitespace-no-wrap bg-gray-900 shadow-lg rounded-md",children:n}),(0,m.jsx)("div",{className:"w-3 h-3 -mt-2 rotate-45 bg-gray-900"})]})]})},z=function(e){var n=e.onConnect;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"bg-y-100 rounded-full h-2 w-2 mr-1"}),(0,m.jsx)("p",{className:"text-sm font-bold text-y-100",children:"You are not connected."})]}),(0,m.jsx)("a",{onClick:n,children:(0,m.jsx)("p",{className:"text-sm font-normal text-y-100 hover:text-y-200 ml-3 cursor-pointer",children:"Sign in with your wallet"})})]}),(0,m.jsxs)("button",{className:"max-w-xs flex items-center text-sm rounded focus:outline-none",onClick:n,children:[(0,m.jsx)("span",{className:"sr-only",children:"Connect"}),(0,m.jsx)(K.Z,{className:"h-6 w-6 md:h-5 md:w-5 fill-n-100 hover:fill-n-200","aria-hidden":"true"})]})]})},U=function(e){var n=e.onConnect,t=e.onDisconnect,r=(0,j.q)(function(e){return e.address}),s=function(){r&&navigator.clipboard.writeText(r)};return(0,m.jsx)("div",{className:"flex ".concat((0,N.HH)()?"bg-p-600":"bg-n-500"," items-center justify-between rounded-lg max-h-16 min-h-[4rem] px-4 py-2 m-2 mt-0 drop-shadow-xl"),children:r?(0,m.jsx)(W.v,{children:function(e){var n=e.open;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:(0,N.AK)(n?"opacity-75":"","flex items-center"),children:r?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(C.Z,{peerAddress:r}),(0,m.jsxs)("div",{className:"flex flex-col ml-3",children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"bg-g-100 rounded h-2 w-2 mr-1"}),(0,m.jsx)("p",{className:"text-sm font-bold text-g-100",children:"Connected as:"})]}),(0,m.jsx)(k.Z,{address:r,className:"text-md leading-4 font-semibold text-white ml-[12px]"})]})]}):(0,m.jsxs)("div",{className:"h-14 flex flex-col flex-1 justify-center",children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"bg-p-100 rounded h-2 w-2 mr-1"}),(0,m.jsx)("p",{className:"text-sm font-bold text-p-100",children:"Connecting..."})]}),(0,m.jsx)("p",{className:"text-sm font-normal text-p-100 ml-3",children:"Verifying your wallet"})]})}),(0,m.jsxs)("div",{className:"flex items-center",children:[(0,N.HH)()&&(0,m.jsx)(L,{message:"You are connected to the dev network",children:(0,m.jsx)("div",{className:"bg-p-200 font-bold mr-1 text-sm p-1 rounded cursor-pointer",children:(0,N.HH)()})}),(0,m.jsx)("div",{children:(0,m.jsxs)(W.v.Button,{className:"max-w-xs flex items-center text-sm rounded-full focus:outline-none",children:[(0,m.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,m.jsx)(K.Z,{className:(0,N.AK)(n?"fill-white":"","h-6 w-6 md:h-5 md:w-5 fill-n-100 hover:fill-n-200"),"aria-hidden":"true"})]})}),(0,m.jsx)(d.u,{as:x.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,m.jsxs)(W.v.Items,{className:"origin-bottom-right absolute right-0 bottom-12 mb-4 w-40 rounded-md shadow-lg bg-white divide-y-2 divide-zinc-50 ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,m.jsx)("div",{className:"px-1 py-1 ",children:(0,m.jsx)(W.v.Item,{children:(0,m.jsxs)("span",{className:"block rounded-md px-2 py-2 text-sm text-n-600 text-right font-normal",children:["xmtp-js v",M.HO.Ay.substring(1)]})})}),(0,m.jsx)("div",{className:"px-1 py-1 ",children:(0,m.jsx)(W.v.Item,{children:function(e){var n=e.active;return(0,m.jsx)("a",{onClick:s,className:(0,N.AK)(n?"bg-zinc-50":"","block rounded-md px-2 py-2 text-sm text-n-600 text-right font-normal cursor-pointer"),children:"Copy wallet address"})}})}),(0,m.jsx)("div",{className:"px-1 py-1 ",children:(0,m.jsx)(W.v.Item,{children:function(e){var n=e.active;return(0,m.jsx)("a",{onClick:t,className:(0,N.AK)(n?"bg-zinc-50 cursor-pointer":"","block rounded-md px-2 py-2 text-sm text-l-300 text-right font-semibold"),children:"Disconnect wallet"})}})})]})})]})]})}}):(0,m.jsx)(z,{onConnect:n})})},X=t(4346),V=function(){var e,n,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=(0,j.q)(function(e){return e.signer}),i=null!==(n=(0,j.q)(function(e){return e.address}))&&void 0!==n?n:"",o=(0,j.q)(function(e){return e.client}),c=(0,j.q)(function(e){return e.setClient}),l=(0,j.q)(function(e){return e.reset}),u=(0,x.useState)(!1),d=u[0],f=u[1],m=function(){l(),r&&(0,N.xO)(i)},h=(0,x.useCallback)((e=(0,s.Z)(a().mark(function e(n){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&!o)){e.next=23;break}if(e.prev=1,f(!0),r=(0,N.XS)(i)){e.next=11;break}if(!t){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,X.Client.getKeys(n,{env:(0,N.dU)(),appVersion:(0,N.Sf)()});case 9:r=e.sent,(0,N.us)(i,r);case 11:return e.next=13,X.Client.create(null,{env:(0,N.dU)(),appVersion:(0,N.Sf)(),privateKeyOverride:r});case 13:c(e.sent),f(!1),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0),c(null),f(!1);case 23:case"end":return e.stop()}},e,null,[[1,18]])})),function(n){return e.apply(this,arguments)}),[o]);return(0,x.useEffect)(function(){d||(r?h(r):m())},[r,h]),{initClient:h}},B=t(76687),G=t(61085);function Y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function J(e){var n,t,r,s=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,r=Symbol.iterator);s--;){if(t&&null!=(n=e[t]))return n.call(e);if(r&&null!=(n=e[r]))return new $(n.call(e));t="@@asyncIterator",r="@@iterator"}throw TypeError("Object is not async iterable")}function $(e){function n(e){if(Object(e)!==e)return Promise.reject(TypeError(e+" is not an object."));var n=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:n}})}return($=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):n(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):n(t.apply(this.s,arguments))}},new $(e)}var Q=function(){var e,n=(0,j.q)(function(e){return e.address}),t=(0,G.Z)().lookupAddress,i=(0,j.q)(function(e){return e.convoMessages}),o=(0,j.q)(function(e){return e.client}),c=(0,j.q)(function(e){return e.conversations}),l=(0,j.q)(function(e){return e.setConversations}),u=(0,j.q)(function(e){return e.addMessages}),d=(0,j.q)(function(e){return e.previewMessages}),f=(0,j.q)(function(e){return e.setPreviewMessages}),m=(0,j.q)(function(e){return e.setPreviewMessage}),h=(0,j.q)(function(e){return e.setLoadingConversations}),p=(0,x.useState)(!0),v=p[0],b=p[1];(0,x.useEffect)(function(){window.addEventListener("focus",function(){return b(!0)}),window.addEventListener("blur",function(){return b(!1)})},[]);var g=(e=(0,s.Z)(a().mark(function e(n){var t,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,N.n2)(n),e.next=3,n.messages({limit:1,direction:X.SortDirection.SORT_DIRECTION_DESCENDING});case 3:if(!((r=e.sent).length<=0)){e.next=6;break}return e.abrupt("return",{key:t});case 6:return e.abrupt("return",{key:t,message:r[0]});case 7:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)});(0,x.useEffect)(function(){if(o){var e,x,p,b,w,j,y,k=(w=(0,s.Z)(a().mark(function e(){var s,c,l,d,x,f,h,p,b,g,w,y,k;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.conversations.streamAllMessages();case 2:j=e.sent,s=!1,c=!1,e.prev=5,d=J(j);case 7:return e.next=9,d.next();case 9:if(!(s=!(x=e.sent).done)){e.next=28;break}if(f=x.value,m(h=(0,N.n2)(f.conversation),f),!(u(h,[f])>0)||((b=null!==(p=i.get(h))&&void 0!==p?p:[]).push(f),g=(0,B.Z)(Array.from(new Map(b.map(function(e){return[e.id,e]})).values())),i.set(h,g),!(r!==f.id&&"granted"===Notification.permission&&f.senderAddress!==n&&!v))){e.next=25;break}return e.next=22,t(null!==(w=f.senderAddress)&&void 0!==w?w:"");case 22:k=e.sent,new Notification("XMTP",{body:"".concat(k||(0,N.sC)(null!==(y=f.senderAddress)&&void 0!==y?y:""),"\n").concat((0,N.$G)(f.content,75))}),r=f.id;case 25:s=!1,e.next=7;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(5),c=!0,l=e.t0;case 34:if(e.prev=34,e.prev=35,!(s&&null!=d.return)){e.next=39;break}return e.next=39,d.return();case 39:if(e.prev=39,!c){e.next=42;break}throw l;case 42:return e.finish(39);case 43:return e.finish(34);case 44:case"end":return e.stop()}},e,null,[[5,30,34,44],[35,,39,43]])})),function(){return w.apply(this,arguments)}),C=(e=(0,s.Z)(a().mark(function e(){var t,r,i,u,x;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Listing conversations"),h(!0),t=new Map(d),e.next=5,o.conversations.list();case 5:return r=e.sent,e.next=8,Promise.all(r.map(g));case 8:i=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y(e,n)}}(e))){t&&(e=t);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(o)throw i}}}}(e.sent);try{for(i.s();!(u=i.n()).done;)(x=u.value).message&&t.set(x.key,x.message)}catch(m){i.e(m)}finally{i.f()}f(t),Promise.all(r.map(function(){var e=(0,s.Z)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.peerAddress!==n&&(c.set((0,N.n2)(t),t),l(new Map(c)));case 1:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}())).then(function(){h(!1),"default"===Notification.permission&&Notification.requestPermission()});case 13:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),A=(x=(0,s.Z)(a().mark(function e(){var t,r,s,i,u,d,x;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.conversations.stream();case 2:y=e.sent,t=!1,r=!1,e.prev=5,i=J(y);case 7:return e.next=9,i.next();case 9:if(!(t=!(u=e.sent).done)){e.next=23;break}if(!((d=u.value).peerAddress!==n)){e.next=20;break}return c.set((0,N.n2)(d),d),l(new Map(c)),e.next=16,g(d);case 16:(x=e.sent).message&&m(x.key,x.message),T(),k();case 20:t=!1,e.next=7;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(5),r=!0,s=e.t0;case 29:if(e.prev=29,e.prev=30,!(t&&null!=i.return)){e.next=34;break}return e.next=34,i.return();case 34:if(e.prev=34,!r){e.next=37;break}throw s;case 37:return e.finish(34);case 38:return e.finish(29);case 39:case"end":return e.stop()}},e,null,[[5,25,29,39],[30,,34,38]])})),function(){return x.apply(this,arguments)}),q=(p=(0,s.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,y.return();case 4:case"end":return e.stop()}},e)})),function(){return p.apply(this,arguments)}),T=(b=(0,s.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=3;break}return e.next=3,j.return(void 0);case 3:case"end":return e.stop()}},e)})),function(){return b.apply(this,arguments)});return C(),A(),k(),function(){q(),T()}}},[o,n])},ee=t(94413),en=t(42484),et=t.n(en),er=t(64488),es=t(80983),ei=function(){var e=(0,f.useRouter)(),n=(0,j.q)(function(e){return e.reset});return{disconnect:(0,x.useCallback)(function(){Object.keys(localStorage).forEach(function(e){e.startsWith("xmtp")&&localStorage.removeItem(e)}),n(),e.push("/")},[e])}},ea=t(34155),eo=function(){var e=(0,x.useState)(),n=e[0],t=e[1],r=(0,j.q)(function(e){return e.setAddress}),i=(0,j.q)(function(e){return e.setSigner}),o=(0,j.q)(function(e){return e.setProvider}),c=ei().disconnect,l=(0,x.useCallback)(function(){c()},[c]),u=(0,x.useCallback)((0,s.Z)(a().mark(function e(){var t,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,N.dI)()){e.next=26;break}if(n){e.next=4;break}throw Error("web3Modal not initialized");case 4:return e.prev=4,e.next=7,n.connect();case 7:if(t=e.sent){e.next=10;break}return e.abrupt("return");case 10:return t.on("accountsChanged",l),c=(s=new ee.ethers.providers.Web3Provider(t,"any")).getSigner(),o(s),i(c),e.t0=r,e.next=18,c.getAddress();case 18:return e.t1=e.sent,(0,e.t0)(e.t1),e.abrupt("return",c);case 23:e.prev=23,e.t2=e.catch(4),console.log("error",e.t2);case 26:case"end":return e.stop()}},e,null,[[4,23]])})),[l,n]);return(0,x.useEffect)(function(){var e,n=ea.env.NEXT_PUBLIC_INFURA_ID||"b6058e03f2cd4108ac890d3876a56d0d",r={walletconnect:{package:er.Z,options:{infuraId:n}}};window.ethereum&&(!window.ethereum||window.ethereum.isCoinbaseWallet)||(r.walletlink={package:es.ZP,options:{appName:"Chat via XMTP",infuraId:n}}),window.ethereum&&window.ethereum.isMetaMask||(r["custom-metamask"]={display:{logo:en.providers.METAMASK.logo,name:"Install MetaMask",description:"Connect using browser wallet"},package:{},connector:(e=(0,s.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open("https://metamask.io");case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}),t(new(et())({cacheProvider:!0,providerOptions:r}))},[]),(0,x.useEffect)(function(){var e;n&&(e=(0,s.Z)(a().mark(function e(){var t,s,c,u,d;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=localStorage.getItem("WEB3_CONNECT_CACHED_PROVIDER")){e.next=4;break}return e.abrupt("return");case 4:return s=JSON.parse(t),e.next=7,n.connectTo(s);case 7:if(c=e.sent){e.next=10;break}return e.abrupt("return");case 10:return c.on("accountsChanged",l),d=(u=new ee.ethers.providers.Web3Provider(c,"any")).getSigner(),o(u),i(d),e.t0=r,e.next=18,d.getAddress();case 18:e.t1=e.sent,(0,e.t0)(e.t1),e.next=25;break;case 22:e.prev=22,e.t2=e.catch(0),console.error(e.t2);case 25:case"end":return e.stop()}},e,null,[[0,22]])})),function(){return e.apply(this,arguments)})()},[n]),{connect:u}},ec=t(34155),el=function(){var e=(0,j.q)(function(e){return e.address}),n=(0,j.q)(function(e){return e.provider}),t=(0,j.q)(function(e){return e.setProvider}),r=(0,j.q)(function(e){return e.setAddress}),i=(0,j.q)(function(e){return e.setSigner}),o=(0,x.useCallback)((0,s.Z)(a().mark(function n(){var t;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(0,N.dI)()){n.next=13;break}if(n.prev=2,e){n.next=8;break}return i(t=ee.Wallet.createRandom()),r(t.address),n.abrupt("return",t);case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),console.log("error",n.t0);case 13:case"end":return n.stop()}},n,null,[[2,10]])})),[e]);return(0,x.useEffect)(function(){n||(t(new ee.ethers.providers.InfuraProvider("mainnet",ec.env.NEXT_PUBLIC_INFURA_ID||"c518355f44bd45709cf0d42567d7bdb4")),o())},[n]),{connect:o}},eu=function(e){var n=e.children,t=(0,j.q)(function(e){return e.client}),r=(0,j.q)(function(e){return e.address}),i=(0,j.q)(function(e){return e.signer}),o=V().initClient;Q();var l=eo().connect,d=ei().disconnect,f=el().connect,g=(0,x.useCallback)((0,s.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:case"end":return e.stop()}},e)})),[d]),w=(0,x.useCallback)((0,s.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,N.dI)()){e.next=7;break}return e.next=5,f();case 5:e.next=9;break;case 7:return e.next=9,l();case 9:if(e.t0=i,!e.t0){e.next=13;break}return e.next=13,o(i);case 13:case"end":return e.stop()}},e)})),[l,o,f,i]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c(),{children:[(0,m.jsx)("title",{children:"Chat via XMTP"}),(0,m.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)(h,{children:(0,m.jsx)("aside",{className:"flex w-full md:w-84 flex-col flex-grow fixed inset-y-0",children:(0,m.jsxs)("div",{className:"flex flex-col flex-grow md:border-r md:border-gray-200 bg-white overflow-y-auto",children:[(0,m.jsxs)("div",{className:"max-h-16 min-h-[4rem] bg-p-600 flex items-center justify-between flex-shrink-0 px-4",children:[(0,m.jsx)(u(),{href:"/",passHref:!0,children:(0,m.jsx)("img",{className:"h-8 w-auto",src:"/xmtp-icon.png",alt:"XMTP"})}),r&&t&&(0,m.jsx)(b,{})]}),(0,m.jsx)(E,{onConnect:w}),(0,m.jsx)(U,{onConnect:w,onDisconnect:g})]})})}),(0,m.jsx)(p,{children:r&&t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex bg-zinc-50 border-b border-gray-200 md:bg-white md:border-0 max-h-16 min-h-[4rem]",children:(0,m.jsx)(v.PG,{})}),n]}):(0,m.jsx)(D,{onConnect:w})})]})]})},ed=function(e){var n=e.children;return(0,m.jsx)(eu,{children:n})}},88677:function(){},46601:function(){},89214:function(){},85568:function(){},52361:function(){},94616:function(){},6567:function(){},42602:function(){}}]);